# ============================================================================
# DATA SPECIFICATION v0.0.1
# Универсальная схема описания логических моделей данных
# ============================================================================
#
# Data Spec описывает ЛОГИЧЕСКУЮ модель предметной области, а не физическую БД.
#
# Философия:
# - Концептуальная модель бизнес-сущностей и отношений
# - Независимость от физической реализации (таблицы, индексы, триггеры)
# - Простота и читаемость для человека и ИИ
# - Фокус на бизнес-логике, а не на оптимизации БД
#
# ============================================================================

# ----------------------------------------------------------------------------
# СТРУКТУРА ФАЙЛА
# ----------------------------------------------------------------------------
# 0. docType - тип документа (обязательно)
# 1. metadata - метаинформация о модели
# 2. description - общее текстовое описание системы
# 3. enums - перечисления (опционально)
# 4. entities - сущности с полями (логические атрибуты)
# 5. relations - логические связи между сущностями (entity_a <-> entity_b)
# 6. diagram - настройки визуализации (опционально)

# ----------------------------------------------------------------------------
# 0. DOCUMENT TYPE (обязательный блок)
# ----------------------------------------------------------------------------
docType: data-spec                # Тип документа (обязательно для парсинга)
format_version: string            # Версия формата (обязательно, например "0.0.1")

# ----------------------------------------------------------------------------
# 1. METADATA (обязательный блок)
# ----------------------------------------------------------------------------
metadata:
  name: string                    # Название системы (обязательно)
  version: string                 # Версия данной спецификации Data Spec (опционально)
  author: string                  # Автор (опционально)
  created_at: date                # Дата создания (опционально)
  updated_at: date                # Дата обновления (опционально)
  description_short: string       # Краткое описание одной строкой (опционально)

# ----------------------------------------------------------------------------
# 2. DESCRIPTION (рекомендуется)
# ----------------------------------------------------------------------------
description: |
  Подробное текстовое описание системы.
  Назначение, цели, основные возможности.
  Может быть многострочным.

# ----------------------------------------------------------------------------
# 3. ENUMS (опционально)
# ----------------------------------------------------------------------------
enums:
  enum_name:                      # Название enum (snake_case)
    values: [val1, val2, val3]    # Краткая форма: просто список значений
    description: string           # Описание enum (опционально)

  # Или полная форма с описанием каждого значения:
  enum_name_detailed:
    description: string           # Описание enum
    values:
      - name: value1
        label: string             # Человекочитаемое название
        description: string       # Описание значения
      - name: value2
        label: string
        description: string

# ----------------------------------------------------------------------------
# 4. ENTITIES (обязательный блок)
# ----------------------------------------------------------------------------
entities:
  entity_name:                    # Название сущности (snake_case)

    # Основная информация
    label: string                 # Человекочитаемое название (опционально)
    description: string           # Описание сущности (рекомендуется)
    table_name: string            # Имя таблицы если отличается от entity_name (опционально)

    # Поля сущности
    fields:
      field_name:                 # Название поля (snake_case)

        # КРАТКАЯ ФОРМА (минимум):
        type: string              # Тип данных (обязательно)

        # ПОЛНАЯ ФОРМА (все опции):
        type: string              # Тип данных (7 базовых логических типов):
                                  # string, integer, decimal, boolean, datetime, uuid, json
                                  # или имя enum из раздела enums
        label: string             # Человекочитаемое название поля
        description: string       # Описание поля

        # Ограничения (логическая модель)
        required: boolean         # Поле обязательно для бизнес-логики (default: false)
        pk: boolean               # Primary key (default: false)
        unique: boolean           # Unique constraint (default: false)
        default: any              # Значение по умолчанию (now, uuid_generate_v4(), literal)

        # Foreign key (логическая ссылка на другую сущность)
        fk: string                # entity_name.field_name (логическая связь)

    # Связи описываются ТОЛЬКО глобально в разделе relations.

    # Составные уникальные ключи (бизнес-ограничение)
    unique_constraints:
      - [field1, field2]          # Список полей для составного unique

# ----------------------------------------------------------------------------
# 5. RELATIONS (глобально, логическая модель)
# ----------------------------------------------------------------------------
# Логическая модель связей - описывает ОТНОШЕНИЯ между сущностями,
# а не физическую реализацию в БД.
# Каждая связь описывается БЕЗ направления (entity_a <-> entity_b)
# и с указанием кардинальности (1:1, 1:N, N:M)
# ----------------------------------------------------------------------------
relations:
  - entity_a: entity_name         # Первая сущность в отношении
    entity_b: entity_name         # Вторая сущность в отношении
    cardinality: string           # one_to_one, one_to_many, many_to_many
    label: string                 # Краткое название связи (например, "employs", "contains")
    description: string           # Подробное описание отношения

# Примеры связей:
#
# 1. One-to-One (1:1):
#   - entity_a: user
#     entity_b: profile
#     cardinality: one_to_one
#     label: "has"
#     description: "Each user has exactly one profile"
#
# 2. One-to-Many (1:N):
#   - entity_a: organization
#     entity_b: user
#     cardinality: one_to_many
#     label: "employs"
#     description: "Organization employs multiple users"
#
# 3. Many-to-Many (N:M):
#   - entity_a: student
#     entity_b: course
#     cardinality: many_to_many
#     label: "enrolls in"
#     description: "Students enroll in multiple courses"

# ----------------------------------------------------------------------------
# 6. DIAGRAM (опционально)
# ----------------------------------------------------------------------------
diagram:
  format: mermaid                 # Формат визуализации
  hints:
    nodes:
      entity_name:
        x: 100                    # Позиция узла (необязательно)
        y: 200
        group: core               # Группа/поддомен
        color: "#3366ff"          # Цвет узла
